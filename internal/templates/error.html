{{define "content"}}
<div class="auth-card">
    <div class="auth-header">
        <h2 class="ui header" style="color: white;">
            <i class="exclamation triangle icon"></i>
            <div class="content">
                Certificate Authentication Error
                <div class="sub header" style="color: rgba(255,255,255,0.8);">
                    We couldn't validate your certificate
                </div>
            </div>
        </h2>
    </div>
    
    <div class="auth-content">
        <div class="error-container">
            <div class="ui error message">
                <i class="close icon"></i>
                <div class="header">{{.ErrorTitle}}</div>
                <p>{{.ErrorMessage}}</p>
            </div>
        </div>
        
        <div class="ui segment">
            <h4 class="ui header">
                <i class="help circle icon"></i>
                <div class="content">
                    What went wrong?
                    <div class="sub header">Common certificate issues</div>
                </div>
            </h4>
            
            {{if eq .ErrorCode "missing_organization_identifier"}}
            <div class="ui info message">
                <i class="info circle icon"></i>
                <div class="content">
                    <div class="header">Organization Certificate Required</div>
                    <p>This service requires an <strong>organizational certificate</strong> (QSeal or QSign) that contains an organization identifier.</p>
                    <p>Personal certificates or certificates without organization identifiers cannot be used for authentication.</p>
                </div>
            </div>
            
            <div class="ui ordered list">
                <div class="item">
                    <div class="content">
                        <div class="header">Check Certificate Type</div>
                        <div class="description">Ensure you're using a QSeal or QSign certificate, not a personal certificate</div>
                    </div>
                </div>
                <div class="item">
                    <div class="content">
                        <div class="header">Verify Certificate Details</div>
                        <div class="description">Your certificate should contain organization information and an organization identifier</div>
                    </div>
                </div>
                <div class="item">
                    <div class="content">
                        <div class="header">Contact Your Organization</div>
                        <div class="description">If you need an organizational certificate, contact your organization's IT department</div>
                    </div>
                </div>
            </div>
            {{end}}
            
            {{if eq .ErrorCode "certificate_expired"}}
            <div class="ui warning message">
                <i class="exclamation triangle icon"></i>
                <div class="content">
                    <div class="header">Certificate Expired</div>
                    <p>Your certificate has expired and cannot be used for authentication.</p>
                    <p>You'll need to obtain a new certificate from your certificate provider.</p>
                </div>
            </div>
            
            <div class="ui ordered list">
                <div class="item">
                    <div class="content">
                        <div class="header">Check Certificate Validity</div>
                        <div class="description">Verify the expiration date of your certificate</div>
                    </div>
                </div>
                <div class="item">
                    <div class="content">
                        <div class="header">Renew Certificate</div>
                        <div class="description">Contact your certificate provider to renew your certificate</div>
                    </div>
                </div>
                <div class="item">
                    <div class="content">
                        <div class="header">Install New Certificate</div>
                        <div class="description">Install the renewed certificate in your certificate store</div>
                    </div>
                </div>
            </div>
            {{end}}
            
            {{if eq .ErrorCode "invalid_certificate"}}
            <div class="ui negative message">
                <i class="times circle icon"></i>
                <div class="content">
                    <div class="header">Invalid Certificate Format</div>
                    <p>The certificate format is invalid or corrupted.</p>
                </div>
            </div>
            
            <div class="ui ordered list">
                <div class="item">
                    <div class="content">
                        <div class="header">Check Certificate Installation</div>
                        <div class="description">Ensure your certificate is properly installed in your certificate store</div>
                    </div>
                </div>
                <div class="item">
                    <div class="content">
                        <div class="header">Reinstall Certificate</div>
                        <div class="description">Try reinstalling the certificate from your certificate provider</div>
                    </div>
                </div>
                <div class="item">
                    <div class="content">
                        <div class="header">Check Browser Settings</div>
                        <div class="description">Verify that your browser is configured to use certificates</div>
                    </div>
                </div>
            </div>
            {{end}}
        </div>
        
        <div class="ui segment">
            <h4 class="ui header">
                <i class="question circle icon"></i>
                <div class="content">
                    Need Help?
                    <div class="sub header">Getting support</div>
                </div>
            </h4>
            
            <div class="ui info message">
                <i class="info circle icon"></i>
                <div class="content">
                    <p>If you continue to experience issues:</p>
                    <ul>
                        <li>Contact your organization's IT support</li>
                        <li>Verify your certificate is from a qualified eIDAS Trust Service Provider</li>
                        <li>Ensure your browser supports client certificate authentication</li>
                        <li>Check that your certificate is properly installed and accessible</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="ui three buttons">
            <button type="button" class="ui button" onclick="window.close()">
                <i class="times icon"></i>
                Close
            </button>
            
            <button type="button" class="ui button" onclick="location.reload()">
                <i class="refresh icon"></i>
                Try Again
            </button>
            
            <button type="button" class="ui btn-primary button" onclick="goBack()">
                <i class="arrow left icon"></i>
                Go Back
            </button>
        </div>
    </div>
</div>

<script>
// Initialize Fomantic UI components
$(document).ready(function() {
    $('.message .close').on('click', function() {
        $(this).closest('.message').transition('fade');
    });
});

// Go back function
function goBack() {
    if (document.referrer) {
        window.location.href = document.referrer;
    } else {
        window.close();
    }
}
</script>
{{end}}
